{
  "hash": "2323ffd0f3ed01d9a8d35de61dfc41ac",
  "result": {
    "markdown": "---\ntitle: \"Compost temperature data\"\nmessage: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(googlesheets4)\nlibrary(hms)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'hms'\n\nThe following object is masked from 'package:lubridate':\n\n    hms\n```\n:::\n\n```{.r .cell-code}\nlibrary(patchwork)\n\ntheme_sovacool <- ggplot2::theme_bw() +\n    ggplot2::theme(\n      legend.margin = ggplot2::margin(0, 0, 0, 0, unit = \"pt\"),\n      legend.box.margin = ggplot2::margin(0, 0, 0, 0, unit = \"pt\"),\n      plot.margin = ggplot2::margin(0, 0, 0, 0, unit = \"pt\")\n    )\n\ntheme_set(theme_sovacool)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_dat <- list.files('data', full.names=TRUE) %>% \n  Filter(\\(x) str_ends(x, '.csv'),.) %>% \n  map(read_csv) %>% \n  bind_rows() %>% \n  distinct() %>% \n  mutate(source_weather = 'NOAA')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 135 Columns: 116\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (22): STATION, NAME, AWND_ATTRIBUTES, PGTM, PGTM_ATTRIBUTES, PRCP_ATTRI...\ndbl  (21): LATITUDE, LONGITUDE, ELEVATION, AWND, PRCP, SNOW, SNWD, TAVG, TMA...\nlgl  (72): ACMC, ACMC_ATTRIBUTES, ACMH, ACMH_ATTRIBUTES, ACSC, ACSC_ATTRIBUT...\ndate  (1): DATE\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\n#gs4_auth()\ncompost_dat <- read_sheet(\n  'https://docs.google.com/spreadsheets/d/1SQbtZQoU_YLeCF9Udu_SHTf0v5Cf-tgrrzdvb2Z2C94/edit?gid=0#gid=0'\n) %>%\n  mutate(\n    date = as_date(datetime),\n    drop = if_else(is.na(drop), FALSE, drop),\n    source_compost = 'KLSC',\n    compost_status = factor(\n      case_when(\n        compost_temp_F < 80 ~ 'dormant',\n        compost_temp_F >= 80 ~ 'steady',\n        compost_temp_F >= 100 ~ 'active',\n        compost_temp_F >= 130 ~ 'hot',\n        compost_temp_F >= 160 ~ 'too hot!'\n      ),\n      levels = c('dormant', 'steady', 'active', 'hot', 'too hot!8️')\n    )\n  ) %>%\n  filter(!drop)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nℹ Suitable tokens found in the cache, associated with these emails:\n• 'davidandkelly210@gmail.com'\n• 'kellysovacool@gmail.com'\n  Defaulting to the first email.\n! Using an auto-discovered, cached token.\n  To suppress this message, modify your code or options to clearly consent to\n  the use of a cached token.\n  See gargle's \"Non-interactive auth\" vignette for more details:\n  <https://gargle.r-lib.org/articles/non-interactive-auth.html>\nℹ The googlesheets4 package is using a cached token for\n  'davidandkelly210@gmail.com'.\nAuto-refreshing stale OAuth token.\n✔ Reading from \"compost\".\n✔ Range 'Sheet1'.\n```\n:::\n\n```{.r .cell-code}\ntz(compost_dat$datetime) <- 'America/Detroit'\n\ndat <- compost_dat %>% \n  mutate(time_hms = as_hms(datetime)) %>% \n  full_join(weather_dat, by = c('date' = 'DATE'))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat %>% \n  ggplot(aes(x = date, y = compost_temp_F)) +\n  geom_hline(yintercept = 32, linetype = 'dotted', linewidth = 0.3, color = 'lightblue') +\n  geom_ribbon(aes(x = date, ymax = TMAX, ymin = TMIN), alpha = 0.5, fill = 'darkgrey') +\n  geom_line(aes(y = TMIN, color = TMIN), linewidth = 1) +\n  geom_line(aes(y = TMAX, color = TMAX), linewidth = 1) +\n  geom_line(aes(group = source_compost), linewidth=0.5) +\n  geom_point(aes(fill = compost_status, group = source_compost), shape = 21, stroke = 0.5, size = 3) +\n  scale_fill_viridis_d() +\n  scale_color_viridis_c() +\n  labs(x = '', y = 'Temperature (Fahrenheit)', \n       title = \"Compost temperature vs Daily high/low air temperature\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 3 rows containing missing values or values outside the scale range\n(`geom_line()`).\nRemoved 3 rows containing missing values or values outside the scale range\n(`geom_line()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 116 rows containing missing values or values outside the scale range\n(`geom_line()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 116 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_temp <- dat %>% \n  ggplot(aes(x = date, y = compost_temp_F)) +\n  geom_hline(yintercept = 32, linetype = 'dotted', linewidth = 0.3, color = 'lightblue') +\n  geom_ribbon(aes(x = date, ymax = TMAX, ymin = TMIN), alpha = 0.5, fill = 'darkgrey') +\n  geom_line(aes(color=compost_status, group = source_compost), linewidth=0.5) +\n  geom_point(aes(fill = compost_status, group = source_compost), shape = 21, stroke = 0.5, size = 3) +\n  scale_fill_viridis_d() +\n  scale_color_viridis_d() +\n  labs(x = '', y = 'Temperature (Fahrenheit)', \n       title = \"Compost temperature vs Daily high/low air temperature\")\n\nplot_temp\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 116 rows containing missing values or values outside the scale range\n(`geom_line()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 116 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/compost_temp-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_obs_time <- dat %>% \n  ggplot(aes(x = date, y = time_hms)) +\n  geom_point() +\n  labs(x = '', y = 'Compost Measurement Time')\n\nplot_temp / plot_obs_time\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 116 rows containing missing values or values outside the scale range\n(`geom_line()`).\nRemoved 116 rows containing missing values or values outside the scale range\n(`geom_point()`).\nRemoved 116 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/compost_temp-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}